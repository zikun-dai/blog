---
title: router
pubDate: 2026-01-13 17:07:48
tags: [tech]
description: 路由器配置
---

## 路由器基础 & 计网复习

### 软路由

进行dhcp、nat等操作，相当于ac
这一步可以直接设置VPN

### 硬路由

只负责无线/有线连接设备，相当于ap

### 旁路由

接在软路由或者硬路由下面，本身联通外网
在路由器/需要翻墙的设备中设置网关和DNS为旁路由IP
appletv、局域网的任意设备都可以作为旁路由（最好是长时间保持开机的设备，mac mini、appletv、nas等低功耗设备最佳）
旁路由出了问题，直接把网关改回主路由

- [ ] 测试一下电脑开梯子作为网关，这样可以给switch开梯子
- [ ] 测一下蒲公英游戏组网
	<img src="router/DCAA2D48-2CE0-4F57-AE1F-C0E53C145353.jpeg" alt="： @客网日记" style="zoom: 25%;" />

### https转发（和旁路由类似）

```
export http_proxy=http://10.48.5.165:7890（本机ip或者局域网其他ip均可）
export https_proxy=$http_proxy
export ALL_PROXY=$http_proxy

```

这样本机的https请求就会转发到指定ip的7890端口

* 电脑VPN开代理模式，终端没网，通过这种方式来在终端访问VPN
* 服务器没有管理员权限，安装clash复杂，可以通过这种方式挂VPN
* 需要借用别人的VPN时，对方把7890端口暴露出来即可访问（Windows自带防火墙，ubuntu平时防火墙关着需要预防一下）

### pppoe

拨号，相当于光猫（通过网线而不是通过光纤）

### dhcp

依托上级网络，上级有网就有网

### 有线中继/bridge/ap

不开dhcp和nat，相当于校园网的一个ap，ip地址分发直接走校园网的ac，相当于直接连接NJU-WLAN
一个ac下接很多ap，单一核心节点的辐射结构（区别于mesh的网络结构）

- [x] 试一下路由器有线中继

### mesh

虽然有主路由，但整体可以形成网络，有线/无线回程时会寻路，以便最快回到主路由

有线组网时子路由相当于ap，但ap不负责dhcp和nat，mesh的子路由会进行（是否仍在同一个网段？还是说只是Wi-Fi名字一样，可以自动切换

无线组网
新建了一个局域网，WAN通过无线传输

### 蓝牙和蓝牙mesh

蓝牙是点对点，手机-》耳机、手机-〉音箱，依赖单一中心节点，超出手机的蓝牙范围就失效
mesh的子节点之间也可以通信，mesh本意就是网格（三维模型的三角面片），覆盖范围更广

### nat

网络地址转发，局域网内的所有子设备都转发到路由器IP来上网
虚拟机guest ip转发到物理机host ip来上网，电脑相当于路由器，给虚拟机分配一个局域网ip
可以在vmware或者virtualbox中将虚拟机的22端口映射到localhost的高端口，物理机就可以ssh访问虚拟机了（映射到0.0.0.0的话局域网其他设备也可以访问）

### 桥接bridge

* 虚拟机直接越过物理机，路由器给分IP（拓扑：路由器-》物理机-〉虚拟机）
* 设备直接越过路由器，校园网给分ip（拓扑：校园网-》路由器-〉设备）
* 再或者，设备直接越过校园网，获得公网ip（ipv6默认就是公网）（拓扑：公网-》校园网-〉设备）

### 校园网打洞

### tailscale

### nat回环

本机guestip：3389映射到路由器hostip：1103
上级网络其他设备当然可以通过hostip：1103来访问，因为同一网段
本机直接访问hostip的话，访问请求传到路由器，路由器处理之后映射回本机，走了一个环（发卡形状）

### localhost本地回环

本机访问本机